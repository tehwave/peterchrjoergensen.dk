---
/**
 * Blog Post Card Component
 *
 * Card-based display for blog post listings. Reuses styling patterns
 * from ProjectCard for visual consistency across site while preserving
 * blog-specific features (publication date, reading time).
 *
 * Matches ProjectCard's hover lift effect and card structure but adapts
 * meta display and tag styling for blog context.
 *
 * Optionally displays a hero image when provided.
 */
import { Picture } from "astro:assets";
import type { ImageMetadata } from "astro";
import BlogTag from "./BlogTag.astro";

interface Props {
  title: string;
  description: string;
  pubDate: Date;
  readingTime?: number;
  tags?: string[];
  href: string;
  heroImage?: ImageMetadata;
  heroImageAlt?: string;
}

const {
  title,
  description,
  pubDate,
  readingTime,
  tags = [],
  href,
  heroImage,
  heroImageAlt = "",
} = Astro.props;

// Format publication date
const formattedDate = pubDate.toLocaleDateString("en-US", {
  year: "numeric",
  month: "long",
  day: "numeric",
});
---

<article class="blog-post-card">
  {
    heroImage && (
      <a href={href} class="blog-post-card__image-link">
        <Picture
          src={heroImage}
          formats={["avif", "webp"]}
          alt={heroImageAlt}
          widths={[400, 600, 800]}
          sizes="(min-width: 768px) 400px, 100vw"
          inferSize={true}
          class="blog-post-card__image"
        />
      </a>
    )
  }
  <div class="blog-post-card__content">
    <div class="blog-post-card__meta">
      <time datetime={pubDate.toISOString()}>
        {formattedDate}
      </time>
      {
        readingTime && (
          <>
            <span class="blog-post-card__separator" aria-hidden="true" />
            <span
              class="blog-post-card__reading-time"
              aria-label={`${readingTime} minute read`}
            >
              {readingTime} min read
            </span>
          </>
        )
      }
    </div>

    <h3 class="blog-post-card__title">
      <a href={href} class="blog-post-card__link">
        {title}
      </a>
    </h3>

    <p class="blog-post-card__description">{description}</p>

    {
      tags.length > 0 && (
        <div class="blog-post-card__tags">
          {tags.map((tag) => (
            <BlogTag tag={tag} />
          ))}
        </div>
      )
    }
  </div>
</article>

<style lang="scss">
  @use "../styles/variables" as *;
  @use "../styles/mixins" as *;

  .blog-post-card {
    background-color: $color-white;
    border-radius: 8px;
    box-shadow: 0 2px 8px $color-shadow;
    @include transition(all, 0.3s);
    display: flex;
    flex-direction: column;
    height: 100%;
    overflow: hidden;

    &:hover {
      transform: translateY(-4px);
      box-shadow: 0 8px 24px $color-shadow-hover;
    }

    &__image-link {
      display: block;
      overflow: hidden;
      aspect-ratio: 16 / 9;
    }

    &__image {
      width: 100%;
      height: 100%;
      object-fit: cover;
      @include transition(transform, 0.3s);

      .blog-post-card:hover & {
        transform: scale(1.05);
      }
    }

    &__content {
      padding: $space-xl;
      display: flex;
      flex-direction: column;
      gap: $space-sm;
      flex-grow: 1;
    }

    &__meta {
      display: flex;
      align-items: center;
      gap: $space-sm;
      font-size: $font-size-sm;
      color: $color-text-muted;

      time {
        color: $color-text-muted;
      }
    }

    &__separator {
      display: inline-block;
      width: 3px;
      height: 3px;
      border-radius: 50%;
      background: $color-text-muted;
    }

    &__reading-time {
      color: $color-text-muted;
    }

    &__title {
      font-size: $font-size-lg;
      font-weight: 600;
      color: $color-text-dark;
      line-height: $leading-snug;
    }

    &__link {
      color: inherit;
      text-decoration: none;
      border-radius: 4px;
      @include focus-visible;

      &:hover {
        color: $color-orange;
      }
    }

    &__description {
      font-size: $font-size-sm;
      color: $color-text-muted;
      line-height: 1.6;
      flex-grow: 1;
    }

    &__tags {
      display: flex;
      flex-wrap: wrap;
      gap: $space-xs;
      margin-top: $space-sm;
    }
  }
</style>
