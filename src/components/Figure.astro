---
/**
 * Figure Component
 *
 * Semantic figure/figcaption wrapper for optimized images with captions.
 * Uses Astro's Picture component for automatic AVIF/WebP generation.
 * Use in MDX blog posts for proper semantic markup.
 *
 * @example
 * ```mdx
 * import Figure from '../../components/Figure.astro';
 * import myImage from '../../assets/blog/my-image.jpg';
 *
 * <Figure
 *   src={myImage}
 *   alt="Description of image"
 *   caption="Photo by Author on Unsplash"
 * />
 * ```
 */

import { Picture } from "astro:assets";
import type { ImageMetadata } from "astro";
import { parseInlineMarkdown } from "../utils/markdown";

interface Props {
  src: ImageMetadata;
  alt: string;
  caption?: string;
}

const { src, alt, caption } = Astro.props;
---

<figure>
  <Picture src={src} formats={["avif", "webp"]} alt={alt} inferSize />
  {caption && <figcaption set:html={parseInlineMarkdown(caption)} />}
</figure>

<style>
  figure img {
    margin-bottom: 0 !important;
  }
</style>
